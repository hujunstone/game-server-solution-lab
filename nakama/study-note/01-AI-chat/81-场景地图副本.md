
# 场景 玩家间的通讯和共享模式
## 地图场景 主城 商店街 野外 Room
交易 社交 探索
AOI + 附近广播 自由走动 与NPC交易
Presence + Storage + AOI 长期存在
## 副本场景 Match
战斗 任务
Match 实时房间 临时用完销毁
临时的
野外打怪 PVE
竞技场 PVP 
团队副本 多人协作

# 位置与坐标
是用真实世界坐标还是自定义的 地点-路线 模式
看他这个感觉是地点路线模式 
## 问题
如果正在移动是否可以和其他玩家通讯？
感觉不用 简单化吧已经在野外了 还是要问问峰哥吧



Storage 持久化，不随链接断开而消失
Presence 当前状态


扩展一份“地图配置表”



地图算法
坐标边界 地图分块 可以参考专用的geo database，基于R tree的。


# 服务器也记录模拟移动
考虑肯定是服务器也要有移动记录的，防止客户端作弊，路线应该也是要记录格子，因为每个格子地形不同，行动的各项指标也不同，不能简单的用地点-路线模型，而是也要用格子模型

1. 游戏里的地图是如何实现的 如何根据玩家的移动和坐标确认玩家到达的位置 每个地理位置的范围是如何标记的
2. Nakama 如何新增 table
3. Nakama 内部有没有地图相关的存储、逻辑、以及接口，代码在哪，如何使用，如何复用或者二次开发
4. 如果服务器不实时记录和计算移动位置如何防止客户端作弊，是否服务器也应该和客户端一致使用格子地图而不是地点路线模型

这个工程里面的room是否和地图有关

## 地图 格子化
每个格子对应的区域id-地名 地形

## 玩家位置
格子坐标或者世界坐标
### 位置判断
玩家世界坐标 → 转成格子索引 → 查这个格子标记的“区域/地点 ID”

## 路网
不做连续坐标，而是把地图抽象成 节点 + 边：
节点：城市、驿站、山口……（node_id）
边：太原府 → 平遥 → 祁县……每条边可以有长度、危险度。





