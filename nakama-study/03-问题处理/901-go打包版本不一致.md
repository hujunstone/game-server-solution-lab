
1. 要求 build 的 docker 版本一致
2. 要求 go 和 docker 镜像的版本一致


# 重装 go 
cd /usr/local 
rm go
tar -C /usr/local -xzf go1.21.6.linux-amd64.tar.gz


```
{"level":"fatal","ts":"2025-12-05T08:06:30.387Z","caller":"main.go:203","msg":"Failed initializing runtime modules","error":"plugin.Open(\"/nakama/data/modules/backend\"): plugin was built with a different version of package internal/godebugs"}
nakama_nakama_1 exited with code 1
```

方法1 自己打包官方镜像

方法2 官方镜像 + 本地挂载 .so


```
   docker run --rm -v ${PWD}:/backend -w /backend `
     registry.heroiclabs.com/heroiclabs/nakama-pluginbuilder:3.21.1 `
     sh -ec "go build --trimpath --mod=readonly --buildmode=plugin -o ./data/modules/backend.so"
```

```
docker run --rm -v ${PWD}:/backend -w /backend `
  registry.heroiclabs.com/heroiclabs/nakama-pluginbuilder:3.21.1 `
  sh -ec "go build --trimpath --mod=readonly --buildmode=plugin -o ./data/modules/backend.so"
```

cd /d/01-git-space-my/game-server-solution-lab/nakama-study

docker run --rm -v "$PWD":/backend -w /backend \
  heroiclabs/nakama-pluginbuilder:3.21.1 \
  sh -ec "go build --trimpath --mod=readonly --buildmode=plugin -o ./data/modules/backend.so"

docker run --rm -v ${PWD}:/backend -w /backend heroiclabs/nakama-pluginbuilder:3.21.1 go build --trimpath --mod=readonly --buildmode=plugin -o ./data/modules/backend.so

docker-compose down
docker-compose up -d
docker-compose logs -f nakama

docker pull heroiclabs/nakama-pluginbuilder:3.21.1


# 删除旧的 data\modules（如果有）
rm -Recurse -Force .\data\modules -ErrorAction SilentlyContinue

# 重新创建目录
mkdir data
mkdir data\modules

镜像 heroiclabs/nakama-pluginbuilder:3.21.1 内置的 Go 版本是 1.21.6（这是 Nakama 官方为该版本插件构建器预设的环境），而你的项目 go.mod 文件中指定了：




