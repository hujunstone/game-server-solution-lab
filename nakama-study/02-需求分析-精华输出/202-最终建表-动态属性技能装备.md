问题
1. 技能应该不需要登记吧，达到经验值就可以升级

角色动态属性表 当前属性
```sql
-- 角色当前属性：四维、HP/DEF等
CREATE TABLE IF NOT EXISTS character_attribute (
    character_id    UUID PRIMARY KEY REFERENCES characters(id) ON DELETE CASCADE,
    -- 四维核心属性
    strength        INT NOT NULL,   -- 力量
    agility         INT NOT NULL,   -- 敏捷
    constitution    INT NOT NULL,   -- 体质
    intelligence    INT NOT NULL,   -- 智慧

    -- 派生属性（可选：也可选择在服务端每次用公式临时计算）
    max_hp          INT NOT NULL,   -- 最大生命值
    current_hp      INT NOT NULL,   -- 当前生命值
    defense         INT NOT NULL,   -- 防御力（可按实际公式调整）
    melee_attack    INT NOT NULL,   -- 近战基础伤害（未含技能加成）
    ranged_attack   INT NOT NULL,   -- 远程基础伤害（未含技能加成）

    created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT now()
);
COMMENT ON TABLE character_attribute IS '角色属性表：四维基础与派生数值（HP/DEF等）';
COMMENT ON COLUMN character_attribute.strength     IS '力量：影响近战伤害、防御与HP';
COMMENT ON COLUMN character_attribute.agility      IS '敏捷：影响远程伤害、闪避等';
COMMENT ON COLUMN character_attribute.constitution IS '体质：主要影响生命值与防御';
COMMENT ON COLUMN character_attribute.intelligence IS '智慧：影响议价、谈判、打探等概率';
COMMENT ON COLUMN character_attribute.max_hp       IS '角色最大生命值（HP = 体质×10 + 力量×2）';
COMMENT ON COLUMN character_attribute.defense      IS '角色防御力（可按体质和力量组合计算）';
COMMENT ON COLUMN character_attribute.melee_attack  IS '近战基础伤害';
COMMENT ON COLUMN character_attribute.ranged_attack IS '远程基础伤害';
```
> HP / DEF 公式建议在服务端统一计算：
> - `HP = 体质 × 10 + 力量 × 2`
> - `DEF = 体质 × 3 + 力量 × 1`（或文档中 DEF 示例公式，按最终设计为准）


# 技能系统
技能定义表
```sql
-- 技能定义：包括树状所属分类等
CREATE TABLE IF NOT EXISTS skill (
    skill_id        UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code            STRING(64) UNIQUE NOT NULL,          -- 技能编码，如 TRADE_APPRAISE 等
    pre_code        STRING(64),                          -- 前置技能编码，如果为 NULL 表示初始技能，不需要前置
    `name`          STRING(64) NOT NULL,                 -- 技能名称（识货、议价、重劈等）
    description     STRING(255),                         -- 技能描述
    tree            STRING(32) NOT NULL,                 -- 所属技能树：trade(商贾之道)/defense(防卫之术)
    `type`          STRING(16) NOT NULL,                 -- 技能类型：active/passive 主动/被动
    min_score       INT,                                 -- 达到该技能所需的最低分数，如果为 NULL 表示初始技能，不需要前置
    created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT now()
);
COMMENT ON TABLE skill IS '技能配置表：定义商贾之道、防卫之术下的各类技能';
COMMENT ON COLUMN skill.code      IS '技能编码，如 TRADE_APPRAISE 等';
COMMENT ON COLUMN skill.pre_code  IS '前置技能编码，如果为 NULL 表示初始技能，不需要前置';
COMMENT ON COLUMN skill.tree      IS '技能所属树：trade(商贾之道)、defense(防卫之术)等';
COMMENT ON COLUMN skill.type      IS '技能类型：active=主动技能，passive=被动技能';
COMMENT ON COLUMN skill.min_score IS '达到该技能所需的最低分数，如果为 NULL 表示初始技能，不需要前置';

```

> 具体数值公式（如议价浮动、打探成功率等）更适合写在服务器逻辑中，DB 只存元信息。

---

角色技能表，角色拥有的技能
```sql
-- 角色技能：记录角色拥有哪些技能以及当前等级、经验
CREATE TABLE IF NOT EXISTS character_skill (
    character_id    UUID NOT NULL REFERENCES characters(id) ON DELETE CASCADE,
    skill_id        UUID NOT NULL REFERENCES skill(skill_id), -- 技能 id
    score           INT  NOT NULL DEFAULT 1,              -- 当前技能分数，达到一定分数后可以解锁后续关联技能
    last_used_at    TIMESTAMPTZ,                          -- 最近一次使用时间（预留，用于冷却统计可以另建表）
    created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    PRIMARY KEY (character_id, skill_id)
);
COMMENT ON TABLE character_skill IS '角色-技能关系表：记录技能等级与经验';
COMMENT ON COLUMN character_skill.score IS '当前技能分数，达到一定分数后可以解锁后续关联技能';
COMMENT ON COLUMN character_skill.score IS '最近一次使用时间（预留，用于冷却统计可以另建表）';
```

# 装备系统

装备位枚举表
```sql
-- 装备位类型：上衣/下装/鞋子/头饰/腰带/饰品/武器等
CREATE TABLE IF NOT EXISTS equip_slot (
    equip_slot_id          UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code        STRING(32) UNIQUE NOT NULL, -- 槽位编码：chest/legs/boots/head/belt/accessory/weapon
    name        STRING(32) NOT NULL,        -- 槽位名称
    description        STRING(255)
);
COMMENT ON TABLE equip_slot IS '装备槽位类型表：定义上衣、下装、鞋子、武器等部位';
```

---

装备品质枚举表
```sql
-- 装备品质：白绿蓝紫橙
CREATE TABLE IF NOT EXISTS item_raritie (
    item_raritie_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code        STRING(32) UNIQUE NOT NULL, -- common/uncommon/rare/epic/legendary 等
    `name`        STRING(32) NOT NULL,      -- 中文名称：普通/精良/优质/稀有/传说
    color       STRING(16),                 -- UI显示颜色标识
    description        STRING(255)
);
COMMENT ON TABLE item_raritie IS '装备品质定义（白/绿/蓝/紫/橙）';
```

---

装备基础定义表
```sql
-- 装备基础定义：名称、部位、品质、基础属性加成
CREATE TABLE IF NOT EXISTS equipments (
    id              UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code            STRING(64) UNIQUE NOT NULL,              -- 装备编码
    name            STRING(64) NOT NULL,                     -- 装备名称（麻布短褐等）
    desc            STRING(255),                             -- 装备描述
    slot_id         UUID NOT NULL REFERENCES equip_slots(id),-- 所属装备位
    rarity_id       UUID NOT NULL REFERENCES item_rarities(id), -- 装备品质
    -- 主属性加成
    bonus_str       INT NOT NULL DEFAULT 0,                  -- 力量加成
    bonus_agi       INT NOT NULL DEFAULT 0,                  -- 敏捷加成
    bonus_con       INT NOT NULL DEFAULT 0,                  -- 体质加成
    bonus_int       INT NOT NULL DEFAULT 0,                  -- 智慧加成
    -- 武器相关（若为武器）
    base_damage     INT NOT NULL DEFAULT 0,                  -- 武器基础伤害加成
    special_effect  STRING(255),                             -- 传说装备特效描述（可为JSON）
    created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT now()
);
COMMENT ON TABLE equipments IS '装备定义表：包含部位、品质及属性加成';
COMMENT ON COLUMN equipments.bonus_str   IS '装备提供的力量加成';
COMMENT ON COLUMN equipments.base_damage IS '武器的基础伤害加成值';
```

> 出生绑定装备（麻布短褐、棉布裈裤等）以及不同出身绑定武器（青竹手杖、熟铁短刀、黄杨算盘）可作为初始数据插入本表，并在角色创建逻辑中为角色生成对应实例。

---

### 5.4 角色已拥有装备表

```sql
-- 角色拥有的装备实例（若需要耐久、绑定等，可扩展）
CREATE TABLE IF NOT EXISTS character_equipment (
    character_equipment_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    character_id    UUID NOT NULL REFERENCES character(id) ON DELETE CASCADE,  -- 角色
    equipment_id    UUID NOT NULL REFERENCES equipment(id),   -- 武器
    equip_slot_id   UUID NOT NULL REFERENCES equip_slot(id),  -- 槽位
    is_equipped     BOOL NOT NULL DEFAULT false,         -- 是否当前已穿戴
    -- 若需要多个同类物品，添加 stack_count 等字段
    created_at      TIMESTAMPTZ NOT NULL DEFAULT now(),
    updated_at      TIMESTAMPTZ NOT NULL DEFAULT now()
);

COMMENT ON TABLE character_equipments IS '角色拥有的装备实例表（背包+已装备）';
COMMENT ON COLUMN character_equipments.is_equipped IS '是否当前处于穿戴状态';
```